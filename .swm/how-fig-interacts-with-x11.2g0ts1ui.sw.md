---
id: 2g0ts1ui
title: How fig interacts with x11
file_version: 1.1.3
app_version: 1.17.0
---

<br/>

<br/>

First fig gets a connection to the x11 server
<!-- NOTE-swimm-snippet: the lines below link your snippet to Swimm -->
### ðŸ“„ src/main.rs
```renderscript
75         let (conn, screen_num) = x11rb::connect(None)?;
```

<br/>

Don't worry about closing `conn`<swm-token data-swm-token=":src/main.rs:75:4:4:`    let (conn, screen_num) = x11rb::connect(None)?;`"/> it's automatically cleaned up by the rust implementation of the connection `drop` trait.

<br/>

then it gets the dimensions of the existing screens for later use. This is what lets us know how big the drawing surfaces should be and how many there are.
<!-- NOTE-swimm-snippet: the lines below link your snippet to Swimm -->
### ðŸ“„ src/main.rs
```renderscript
77         let screens = dbg!(query_screens(&conn)?.reply()?);
78         let screen_rects = {
79             let mut screen_rects = Vec::new();
80             for screen in screens.screen_info {
81                 let rect = Rect::new(
82                     screen.x_org as i32,
83                     screen.y_org as i32,
84                     screen.width as u32,
85                     screen.height as u32,
86                 );
87                 screen_rects.push(rect);
88             }
89             screen_rects
90         };
```

<br/>

A window id handle is created giving the rest of the program something to draw on.
<!-- NOTE-swimm-snippet: the lines below link your snippet to Swimm -->
### ðŸ“„ src/main.rs
```renderscript
92         let win_id = create_desktop(&conn, screen_num)?;
```

<br/>

In order to tell a window manager how to treat this new drawing space some atoms are set.
<!-- NOTE-swimm-snippet: the lines below link your snippet to Swimm -->
### ðŸ“„ src/main.rs
```renderscript
95         set_desktop_atoms(&conn, win_id)?;
```

<br/>

This sets the `_NET_WM_WINDOW_TYPE`<swm-token data-swm-token=":src/main.rs:314:9:9:`        .intern_atom(false, b&quot;_NET_WM_WINDOW_TYPE&quot;)?`"/> atom to the value `_NET_WM_WINDOW_TYPE_DESKTOP`<swm-token data-swm-token=":src/main.rs:318:9:9:`        .intern_atom(false, b&quot;_NET_WM_WINDOW_TYPE_DESKTOP&quot;)?`"/>. Think of this as a key value set operation.
<!-- NOTE-swimm-snippet: the lines below link your snippet to Swimm -->
### ðŸ“„ src/main.rs
```renderscript
313        let atom_wm_type = conn
314            .intern_atom(false, b"_NET_WM_WINDOW_TYPE")?
315            .reply()?
316            .atom;
317        let atom_wm_desktop = conn
318            .intern_atom(false, b"_NET_WM_WINDOW_TYPE_DESKTOP")?
319            .reply()?
320            .atom;
321    
322        Ok(conn.change_property32(
323            PropMode::REPLACE,
324            win_id,
325            atom_wm_type,
326            AtomEnum::ATOM,
327            &[atom_wm_desktop],
```

<br/>

Next x11 is told to map the window and make it available for use with `show_desktop`<swm-token data-swm-token=":src/main.rs:94:1:1:`    show_desktop(&amp;conn, win_id)?;`"/>.

<br/>

This file was generated by Swimm. [Click here to view it in the app](https://app.swimm.io/repos/Z2l0aHViJTNBJTNBZmlnJTNBJTNBd2h5dGhlcGxhdHlwdXM=/docs/2g0ts1ui).
