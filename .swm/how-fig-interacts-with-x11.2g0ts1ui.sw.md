---
id: 2g0ts1ui
title: How fig interacts with x11
file_version: 1.1.3
app_version: 1.17.0
---

<br/>

<br/>

First fig gets a connection to the x11 server
<!-- NOTE-swimm-snippet: the lines below link your snippet to Swimm -->
### ðŸ“„ src/main.rs
```renderscript
77         let (conn, screen_num) = x11rb::connect(None).unwrap();
```

<br/>

Don't worry about closing `conn`<swm-token data-swm-token=":src/main.rs:77:4:4:`    let (conn, screen_num) = x11rb::connect(None).unwrap();`"/> it's automatically cleaned up by the rust implementation of the connection `drop` trait.

<br/>

then it gets the dimensions of the existing screens for later use. This is what lets us know how big the drawing surfaces should be and how many there are.
<!-- NOTE-swimm-snippet: the lines below link your snippet to Swimm -->
### ðŸ“„ src/main.rs
```renderscript
79         let screens = dbg!(query_screens(&conn).unwrap().reply().unwrap());
80         let screen_rects = {
81             let mut screen_rects = Vec::new();
82             for screen in screens.screen_info {
83                 let rect = Rect::new(
84                     screen.x_org as i32,
85                     screen.y_org as i32,
86                     screen.width as u32,
87                     screen.height as u32,
88                 );
89                 screen_rects.push(rect);
90             }
91             screen_rects
92         };
```

<br/>

A window id handle is created giving the rest of the program something to draw on.
<!-- NOTE-swimm-snippet: the lines below link your snippet to Swimm -->
### ðŸ“„ src/main.rs
```renderscript
94         let win_id = create_desktop(&conn, screen_num).unwrap();
```

<br/>

In order to tell a window manager how to treat this new drawing space some atoms are set.
<!-- NOTE-swimm-snippet: the lines below link your snippet to Swimm -->
### ðŸ“„ src/main.rs
```renderscript
95         set_desktop_atoms(&conn, win_id)?;
```

<br/>

This sets the `_NET_WM_WINDOW_TYPE`<swm-token data-swm-token=":src/main.rs:199:9:9:`        .intern_atom(false, b&quot;_NET_WM_WINDOW_TYPE&quot;)`"/> atom to the value `_NET_WM_WINDOW_TYPE_DESKTOP`<swm-token data-swm-token=":src/main.rs:205:9:9:`        .intern_atom(false, b&quot;_NET_WM_WINDOW_TYPE_DESKTOP&quot;)`"/>. Think of this as a key value set operation.
<!-- NOTE-swimm-snippet: the lines below link your snippet to Swimm -->
### ðŸ“„ src/main.rs
```renderscript
198        let atom_wm_type = conn
199            .intern_atom(false, b"_NET_WM_WINDOW_TYPE")
200            .unwrap()
201            .reply()
202            .unwrap()
203            .atom;
204        let atom_wm_desktop = conn
205            .intern_atom(false, b"_NET_WM_WINDOW_TYPE_DESKTOP")
206            .unwrap()
207            .reply()
208            .unwrap()
209            .atom;
210    
211        conn.change_property32(
212            PropMode::REPLACE,
213            win_id,
214            atom_wm_type,
215            AtomEnum::ATOM,
216            &[atom_wm_desktop],
217        )
```

<br/>

Next x11 is told to map the window and make it available for use with `show_desktop`<swm-token data-swm-token=":src/main.rs:96:1:1:`    show_desktop(&amp;conn, win_id)?;`"/>.

<br/>

This file was generated by Swimm. [Click here to view it in the app](https://app.swimm.io/repos/Z2l0aHViJTNBJTNBZmlnJTNBJTNBd2h5dGhlcGxhdHlwdXM=/docs/2g0ts1ui).
